import jieba
from gensim.models import Word2Vec
import re
import random

# 1. å‡†å¤‡è¯­æ–™å¹¶è®­ç»ƒæ¨¡å‹ï¼ˆä½¿ç”¨æ‰©å±•è¯­æ–™æé«˜æ¸¸æˆä½“éªŒï¼‰
corpus = [
  """å¥½çš„ï¼Œæˆ‘ä»¬æ¥å°†è¿™äº›æ ¸å¿ƒå¥å­è¿›è¡Œæ·±åº¦æ‰©å†™ï¼Œæ„å»ºä¸€ç¯‡å…³äºè‡ªç„¶è¯­è¨€å¤„ç†ã€è¯å‘é‡å’Œæœºå™¨å­¦ä¹ çš„è¯¦å°½æ–‡ç« ã€‚æ‰©å†™å°†éµå¾ªé€»è¾‘é€’è¿›çš„ç»“æ„ï¼Œä»å®è§‚é¢†åŸŸä»‹ç»åˆ°å…·ä½“æŠ€æœ¯ç»†èŠ‚ï¼Œå†æ¢è®¨åº”ç”¨ä¸æœªæ¥å±•æœ›ï¼ŒåŠ›æ±‚å†…å®¹ç¿”å®ã€æ·±å…¥æµ…å‡ºã€‚

ä»ç¬¦å·åˆ°è¯­ä¹‰ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ã€è¯å‘é‡ä¸æœºå™¨å­¦ä¹ çš„æ·±åº¦æ¢ç´¢

ç¬¬ä¸€ç« ï¼šäººå·¥æ™ºèƒ½çš„ç‘°å®â€”â€”è‡ªç„¶è¯­è¨€å¤„ç†

â€œè‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯â€â€”â€”è¿™å¥è¯çœ‹ä¼¼ç®€å•ï¼Œå´æ‰¿è½½ç€äººå·¥æ™ºèƒ½é¢†åŸŸæœ€å®å¤§ã€æœ€å¤æ‚çš„æ¢¦æƒ³ä¹‹ä¸€ã€‚è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œç®€ç§°NLPï¼Œå…¶ç»ˆæç›®æ ‡æ˜¯æ‰“ç ´äººä¸æœºå™¨ä¹‹é—´çš„æ²Ÿé€šå£å’ï¼Œè®©è®¡ç®—æœºèƒ½å¤Ÿåƒäººç±»ä¸€æ ·ç†è§£ã€é˜é‡Šã€ç”šè‡³ç”Ÿæˆè‡ªç„¶è¯­è¨€ã€‚

è¦æ·±å…¥ç†è§£NLPçš„é‡è¦æ€§ï¼Œæˆ‘ä»¬å¿…é¡»å°†å…¶ç½®äºäººå·¥æ™ºèƒ½å‘å±•çš„å®å¤§å›¾æ™¯ä¸­ã€‚äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒæ˜¯è®©æœºå™¨å…·å¤‡æ™ºèƒ½ï¼Œèƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºæ…§çš„ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡æ¶µç›–äº†æ„ŸçŸ¥ï¼ˆå¦‚è®¡ç®—æœºè§†è§‰ã€è¯­éŸ³è¯†åˆ«ï¼‰ã€æ¨ç†ã€çŸ¥è¯†è¡¨è¾¾å’Œå†³ç­–ç­‰å¤šä¸ªå±‚é¢ã€‚è€Œè‡ªç„¶è¯­è¨€ï¼Œä½œä¸ºäººç±»çŸ¥è¯†ã€æ–‡åŒ–ã€æ€æƒ³å’Œæƒ…æ„Ÿæœ€ä¸»è¦çš„è½½ä½“ï¼Œæ— ç–‘æ˜¯äººå·¥æ™ºèƒ½å¿…é¡»æ”»å…‹çš„â€œç»ˆæé«˜åœ°â€ã€‚å¦‚æœæœºå™¨æ— æ³•ç†è§£è¯­è¨€ï¼Œé‚£ä¹ˆå®ƒå¯¹äºäººç±»ä¸–ç•Œçš„è®¤çŸ¥å°†æ˜¯æå…¶ç‰‡é¢å’Œè‚¤æµ…çš„ã€‚å› æ­¤ï¼ŒNLPä¸ä»…æ˜¯AIçš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ›´æ˜¯è¿æ¥AIä¸äººç±»ç¤¾ä¼šçš„æ¡¥æ¢ï¼Œæ˜¯è¡¡é‡äººå·¥æ™ºèƒ½å‘å±•æ°´å¹³çš„å…³é”®æ ‡å°ºã€‚

NLPçš„ç ”ç©¶èŒƒå›´æå…¶å¹¿æ³›ï¼Œä»ä¸Šä¸–çºª50å¹´ä»£çš„æ—©æœŸæœºå™¨ç¿»è¯‘ç ”ç©¶ï¼ˆå¦‚è‘—åçš„ä¹”æ²»æ•¦-IBMå®éªŒï¼‰åˆ°ä»Šå¤©æ— å¤„ä¸åœ¨çš„æ™ºèƒ½åŠ©æ‰‹ã€æœºå™¨ç¿»è¯‘å¼•æ“å’Œæœç´¢å¼•æ“ï¼Œå…¶å‘å±•å†ç¨‹æ³¢æ¾œå£®é˜”ã€‚æ—©æœŸçš„NLPç³»ç»Ÿä¸»è¦ä¾èµ–äºåŸºäºè§„åˆ™çš„æ–¹æ³•ã€‚è¯­è¨€å­¦å®¶å’Œè®¡ç®—æœºç§‘å­¦å®¶ä»¬è¯•å›¾å°†äººç±»è¯­è¨€çš„è¯­æ³•è§„åˆ™ï¼ˆå¦‚å¥æ³•ç»“æ„ã€è¯æ€§æ ‡æ³¨ï¼‰å’Œè¯å…¸çŸ¥è¯†ç¡¬ç¼–ç åˆ°è®¡ç®—æœºä¸­ã€‚ä¾‹å¦‚ï¼Œè¦å¤„ç†â€œThe cat sat on the matâ€è¿™ä¸ªå¥å­ï¼Œç³»ç»Ÿéœ€è¦é¢„å…ˆå®šä¹‰â€œcatâ€æ˜¯åè¯ã€â€œsatâ€æ˜¯åŠ¨è¯ã€â€œonâ€æ˜¯ä»‹è¯ï¼Œå¹¶è§„å®šâ€œåè¯+åŠ¨è¯+ä»‹è¯+åè¯â€æ˜¯ä¸€ç§åˆæ³•çš„å¥å­ç»“æ„ã€‚è¿™ç§æ–¹æ³•åœ¨å—é™é¢†åŸŸæˆ–ç®€å•å¥å­ä¸Šå¯èƒ½æœ‰æ•ˆï¼Œä½†é¢å¯¹äººç±»è¯­è¨€æ— ç©·çš„åˆ›é€ åŠ›ã€å¤æ‚çš„æ­§ä¹‰ç°è±¡ï¼ˆå¦‚â€œI saw the man with the telescopeâ€ï¼‰ã€ä¸°å¯Œçš„ä¿šè¯­å’Œæ–°è¯æ—¶ï¼Œä¾¿æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚è§„åˆ™ç³»ç»Ÿè„†å¼±ã€éš¾ä»¥æ‰©å±•ï¼Œä¸”æ„å»ºæˆæœ¬æé«˜ï¼Œè¿™æˆä¸ºäº†NLPå‘å±•çš„ç¬¬ä¸€ä¸ªä¸»è¦ç“¶é¢ˆã€‚

ç›´åˆ°20ä¸–çºªæœ«21ä¸–çºªåˆï¼Œéšç€äº’è”ç½‘çš„æ™®åŠå’Œè®¡ç®—èƒ½åŠ›çš„æå‡ï¼Œä¸€ç§æ–°çš„èŒƒå¼å½»åº•æ”¹å˜äº†NLPä¹ƒè‡³æ•´ä¸ªAIé¢†åŸŸçš„ç ”ç©¶è·¯å¾„â€”â€”è¿™å°±æ˜¯åŸºäºç»Ÿè®¡çš„æ–¹æ³•ï¼Œäº¦å³æœºå™¨å­¦ä¹ ã€‚NLPçš„ç ”ç©¶é‡å¿ƒä»â€œæ•™è®¡ç®—æœºè¯­æ³•è§„åˆ™â€è½¬å‘äº†â€œè®©è®¡ç®—æœºä»æµ·é‡æ•°æ®ä¸­è‡ªè¡Œå­¦ä¹ è¯­è¨€è§„å¾‹â€ã€‚è¿™ä¸€è½¬å˜æ˜¯é©å‘½æ€§çš„ï¼Œå®ƒæ„å‘³ç€æˆ‘ä»¬ä¸å†éœ€è¦ç©·å°½ä¸€åˆ‡å¯èƒ½å»æ‰‹åŠ¨ç¼–å†™è§„åˆ™ï¼Œè€Œæ˜¯å¯ä»¥åˆ©ç”¨æ•°æ®é©±åŠ¨çš„æ–¹å¼ï¼Œè®©æ¨¡å‹è‡ªåŠ¨å‘ç°è¯­è¨€ä¸­çš„æ¦‚ç‡æ€§æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡åˆ†ææ•°åäº¿è®¡çš„ç½‘é¡µæ–‡æœ¬ï¼Œè®¡ç®—æœºä¼šå‘ç°â€œçŒ«â€è¿™ä¸ªè¯åé¢å‡ºç°â€œç‹—â€çš„æ¦‚ç‡ï¼Œè¿œé«˜äºå‡ºç°â€œå“²å­¦â€çš„æ¦‚ç‡ã€‚è¿™ç§ä»å¤§æ•°æ®ä¸­æŒ–æ˜å‡ºçš„å…±ç°ç»Ÿè®¡è§„å¾‹ï¼Œä¸ºè¯­è¨€ç†è§£æä¾›äº†è¿œæ¯”è§„åˆ™ç³»ç»Ÿæ›´åšå®ã€æ›´çµæ´»çš„åŸºç¡€ã€‚è‡³æ­¤ï¼ŒNLPä¸æœºå™¨å­¦ä¹ ç´§å¯†åœ°ç»“åˆåœ¨äº†ä¸€èµ·ï¼Œå¹¶é€æ­¥æ¼”è¿›ä¸ºæˆ‘ä»¬ä»Šå¤©æ‰€è§çš„ï¼Œä»¥æ·±åº¦å­¦ä¹ ä¸ºä¸»å¯¼çš„ç°ä»£è‡ªç„¶è¯­è¨€å¤„ç†ã€‚

ç¬¬äºŒç« ï¼šæ•°æ®çš„ç‡ƒæ–™â€”â€”æœºå™¨å­¦ä¹ çš„åŸºçŸ³

â€œæœºå™¨å­¦ä¹ éœ€è¦å¤§é‡çš„æ•°æ®è®­ç»ƒæ¨¡å‹â€ï¼Œè¿™æ­ç¤ºäº†ç°ä»£AIï¼Œå°¤å…¶æ˜¯æ•°æ®é©±åŠ¨èŒƒå¼çš„æ ¸å¿ƒç‰¹å¾ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯å¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæ¯”å–»ä¸ºä¸€ä¸ªæå…¶èªæ˜ä½†ç¼ºä¹ç»éªŒçš„å­¦ç”Ÿã€‚æ•°æ®ï¼Œå°±æ˜¯è¿™ä½å­¦ç”Ÿçš„æ•™ç§‘ä¹¦ã€ä¹ é¢˜é›†å’Œç™¾ç§‘å…¨ä¹¦ã€‚æ²¡æœ‰è¶³å¤Ÿæ•°é‡å’Œé«˜è´¨é‡çš„æ•°æ®ï¼Œå†ä¼˜ç§€çš„ç®—æ³•ä¹Ÿæ— æ³•å­¦ä¼šå®Œæˆç‰¹å®šä»»åŠ¡ã€‚

ä¸ºä»€ä¹ˆæ•°æ®å¦‚æ­¤å…³é”®ï¼Ÿå› ä¸ºæœºå™¨å­¦ä¹ çš„æœ¬è´¨æ˜¯é€šè¿‡ä¼˜åŒ–ç®—æ³•ï¼Œè°ƒæ•´æ¨¡å‹å†…éƒ¨æ•°ç™¾ä¸‡ç”šè‡³æ•°åäº¿çš„å‚æ•°ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿä»è¾“å…¥æ•°æ®æ˜ å°„åˆ°æœŸæœ›çš„è¾“å‡ºã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œè®­ç»ƒâ€ã€‚ä»¥å›¾åƒåˆ†ç±»ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬å‘ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œå±•ç¤ºæˆåƒä¸Šä¸‡å¼ æ ‡æ³¨ä¸ºâ€œçŒ«â€å’Œâ€œç‹—â€çš„å›¾ç‰‡æ—¶ï¼Œæ¨¡å‹ä¼šä¸æ–­åœ°æ¯”è¾ƒè‡ªå·±çš„é¢„æµ‹ï¼ˆâ€œè¿™å¼ å›¾ç‰‡æ˜¯çŒ«â€ï¼‰ä¸çœŸå®ç­”æ¡ˆï¼ˆâ€œè¿™æ˜¯ç‹—â€ï¼‰ä¹‹é—´çš„å·®å¼‚ï¼ˆå³æŸå¤±å‡½æ•°ï¼‰ï¼Œç„¶åé€šè¿‡åå‘ä¼ æ’­ç®—æ³•å¾®è°ƒå…¶å†…éƒ¨å‚æ•°ï¼Œä»¥å‡å°‘ä¸‹ä¸€æ¬¡é¢„æµ‹çš„è¯¯å·®ã€‚ç»è¿‡æµ·é‡æ•°æ®çš„åå¤â€œå­¦ä¹ â€ï¼Œæ¨¡å‹æœ€ç»ˆèƒ½å¤Ÿæ•æ‰åˆ°â€œçŒ«â€å’Œâ€œç‹—â€æœ€æœ¬è´¨ã€æœ€ç»†å¾®çš„è§†è§‰ç‰¹å¾ï¼ˆå¦‚è€³æœµå½¢çŠ¶ã€é¢éƒ¨è½®å»“ï¼‰ï¼Œä»è€Œå¯¹ä»æœªè§è¿‡çš„æ–°å›¾ç‰‡åšå‡ºå‡†ç¡®åˆ¤æ–­ã€‚

åœ¨NLPé¢†åŸŸï¼Œæ•°æ®çš„è§’è‰²åŒæ ·è‡³å…³é‡è¦ã€‚è€Œä¸”ï¼ŒNLPä»»åŠ¡æ‰€éœ€çš„æ•°æ®å¾€å¾€æ˜¯éç»“æ„åŒ–çš„æ–‡æœ¬æ•°æ®ï¼Œå…¶å¤„ç†éš¾åº¦æ›´å¤§ã€‚è¿™äº›æ•°æ®æ„æˆäº†æ¨¡å‹çš„è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ã€‚æ•°æ®çš„â€œå¤§é‡â€ä½“ç°åœ¨ä¸‰ä¸ªç»´åº¦ï¼šè§„æ¨¡ã€è´¨é‡å’Œå¤šæ ·æ€§ã€‚
1.  è§„æ¨¡ï¼šæ·±åº¦å­¦ä¹ æ¨¡å‹å…·æœ‰å·¨å¤§çš„å®¹é‡ï¼Œè¶³å¤Ÿçš„æ•°æ®é‡æ˜¯é˜²æ­¢æ¨¡å‹â€œè¿‡æ‹Ÿåˆâ€çš„å…³é”®ã€‚è¿‡æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹ä»…ä»…è®°ä½äº†è®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°å’Œç‰¹å®šæ ·æœ¬ç‰¹å¾ï¼Œè€Œéå­¦ä¹ åˆ°åº•å±‚çš„é€šç”¨è§„å¾‹ï¼Œå¯¼è‡´å…¶åœ¨æœªè§æ•°æ®ä¸Šè¡¨ç°ç³Ÿç³•ã€‚æ›´å¤šçš„æ•°æ®æœ‰åŠ©äºæ¨¡å‹æ³›åŒ–åˆ°æ›´æ™®éçš„æƒ…å†µã€‚
2.  è´¨é‡ï¼šåƒåœ¾è¿›ï¼Œåƒåœ¾å‡ºã€‚å¦‚æœè®­ç»ƒæ•°æ®å……æ»¡äº†é”™è¯¯æ ‡æ³¨ã€åè§å’Œå™ªå£°ï¼Œæ¨¡å‹å­¦åˆ°çš„ä¹Ÿå°†æ˜¯é”™è¯¯å’Œæœ‰åè§çš„çŸ¥è¯†ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨å¸¦æœ‰æ€§åˆ«åè§çš„æ•°æ®è®­ç»ƒçš„ç®€å†ç­›é€‰ç³»ç»Ÿï¼Œå¯èƒ½ä¼šä¸å…¬æ­£åœ°åå‘ç”·æ€§å€™é€‰äººã€‚
3.  å¤šæ ·æ€§ï¼šæ•°æ®éœ€è¦è¦†ç›–ä»»åŠ¡å¯èƒ½é‡åˆ°çš„å„ç§åœºæ™¯å’Œè¯­è¨€é£æ ¼ã€‚ä¾‹å¦‚ï¼Œè®­ç»ƒä¸€ä¸ªå®¢æœæœºå™¨äººï¼Œå¦‚æœæ•°æ®åªåŒ…å«æ­£å¼ä¹¦é¢è¯­ï¼Œé‚£ä¹ˆå®ƒåœ¨å¤„ç†å£è¯­åŒ–ã€å¸¦æœ‰é”™åˆ«å­—æˆ–æ–¹è¨€çš„ç”¨æˆ·æé—®æ—¶å°±ä¼šè¡¨ç°ä¸ä½³ã€‚

æ­£æ˜¯ç”±äºå¯¹æ•°æ®çš„æåº¦æ¸´æ±‚ï¼Œäº’è”ç½‘æˆä¸ºäº†NLPå‘å±•çš„æœ€å¤§å®è—ã€‚ç»´åŸºç™¾ç§‘ã€æ–°é—»ç½‘ç«™ã€ç¤¾äº¤åª’ä½“ã€ä¹¦ç±æ‰«æé¡¹ç›®ç­‰æä¾›äº†å‰æ‰€æœªæœ‰çš„æµ·é‡æ–‡æœ¬è¯­æ–™åº“ï¼Œä¸ºè®­ç»ƒå¼ºå¤§çš„è¯­è¨€æ¨¡å‹å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚è¿™ä¹Ÿå¼•å‡ºäº†ä¸‹ä¸€ä¸ªå…³é”®ç¯èŠ‚ï¼šå¦‚ä½•å°†è¿™äº›åŸå§‹çš„ã€ç¬¦å·åŒ–çš„æ–‡æœ¬æ•°æ®ï¼Œè½¬åŒ–ä¸ºæœºå™¨å¯ä»¥ç†è§£å’Œå¤„ç†çš„æ•°å€¼å½¢å¼ï¼Ÿè¿™å°±éœ€è¦è¿›è¡Œç²¾ç»†çš„æ–‡æœ¬é¢„å¤„ç†ã€‚

ç¬¬ä¸‰ç« ï¼šæ–‡æœ¬çš„åŸºçŸ³â€”â€”é¢„å¤„ç†ä¸åˆ†è¯

â€œåˆ†è¯æ˜¯æ–‡æœ¬é¢„å¤„ç†çš„å…³é”®æ­¥éª¤â€ã€‚åœ¨å°†æ–‡æœ¬æ•°æ®â€œå–‚â€ç»™æœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹å‰ï¼Œå¿…é¡»å¯¹å…¶è¿›è¡Œä¸€ç³»åˆ—è§„èŒƒåŒ–å¤„ç†ï¼Œç»Ÿç§°ä¸ºæ–‡æœ¬é¢„å¤„ç†ã€‚è¿™ä¸ªè¿‡ç¨‹çš„ç›®çš„åœ¨äºæ¸…æ´—å™ªå£°ã€æ ‡å‡†åŒ–æ ¼å¼ï¼Œå¹¶å°†äººç±»å¯è¯»çš„æ–‡æœ¬è½¬æ¢æˆç»“æ„åŒ–çš„ã€æœºå™¨å¯è¯»çš„åŸºæœ¬å•å…ƒã€‚é¢„å¤„ç†é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š
â€¢   æ•°æ®æ¸…æ´—ï¼šå»é™¤HTMLæ ‡ç­¾ã€æ— å…³çš„ç¬¦å·ã€å¼‚å¸¸å­—ç¬¦ç­‰ã€‚

â€¢   æ–‡æœ¬è§„èŒƒåŒ–ï¼šå°†å­—æ¯ç»Ÿä¸€ä¸ºå°å†™ã€å¤„ç†ç¼©å†™è¯ï¼ˆå¦‚å°†â€œisnâ€˜tâ€æ‰©å±•ä¸ºâ€œis notâ€ï¼‰ã€çº æ­£å¸¸è§æ‹¼å†™é”™è¯¯ç­‰ã€‚

â€¢   åœç”¨è¯å»é™¤ï¼šè¿‡æ»¤æ‰å‡ºç°é¢‘ç‡æé«˜ä½†è¯­ä¹‰ä¿¡æ¯è¾ƒå°‘çš„è¯è¯­ï¼Œå¦‚è‹±æ–‡ä¸­çš„â€œthe", â€œa", â€œis"ï¼Œä¸­æ–‡ä¸­çš„â€œçš„â€ã€â€œæ˜¯â€ã€â€œåœ¨â€ç­‰ï¼Œä»¥é™ä½æ•°æ®ç»´åº¦å’Œå™ªå£°ã€‚

â€¢   è¯å¹²æå–ä¸è¯å½¢è¿˜åŸï¼šå°†è¯è¯­çš„ä¸åŒå½¢æ€å½’å¹¶åˆ°å…¶åŸå½¢æˆ–è¯å¹²ï¼Œå¦‚å°†â€œrunning", â€œran", â€œrunsâ€éƒ½è¿˜åŸä¸ºâ€œrunâ€ã€‚

åœ¨æ‰€æœ‰è¿™äº›æ­¥éª¤ä¸­ï¼Œå¯¹äºè®¸å¤šè¯­è¨€ï¼ˆå°¤å…¶æ˜¯æ±‰è¯­è¿™æ ·çš„å­¤ç«‹è¯­ï¼‰è€Œè¨€ï¼Œåˆ†è¯æ˜¯æœ€åŸºç¡€ã€æœ€æ ¸å¿ƒçš„ä¸€æ­¥ã€‚å¯¹äºè‹±è¯­ç­‰ç©ºæ ¼åˆ†éš”çš„è¯­è¨€ï¼Œåˆ†è¯ç›¸å¯¹ç®€å•ï¼Œé€šå¸¸ä»¥ç©ºæ ¼å’Œæ ‡ç‚¹è¿›è¡Œåˆ‡åˆ†å³å¯ã€‚ä½†å¯¹äºæ±‰è¯­ã€æ—¥è¯­ç­‰è¯­è¨€ï¼Œè¯è¯­ä¹‹é—´æ²¡æœ‰å¤©ç„¶çš„åˆ†éš”ç¬¦ï¼Œåˆ†è¯å°±æˆäº†ä¸€ä¸ªå¿…é¡»é¦–å…ˆè§£å†³çš„å¤æ‚ä»»åŠ¡ã€‚

ä¾‹å¦‚ï¼Œå¥å­â€œè‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯â€éœ€è¦è¢«æ­£ç¡®åœ°åˆ‡åˆ†ä¸ºâ€œè‡ªç„¶è¯­è¨€å¤„ç† / æ˜¯ / äººå·¥æ™ºèƒ½ / çš„ / é‡è¦ / åˆ†æ”¯â€ï¼Œè€Œä¸æ˜¯é”™è¯¯çš„â€œè‡ªç„¶ / è¯­è¨€ / å¤„ç† / æ˜¯ / äººå·¥ / æ™ºèƒ½ / çš„ / é‡è¦ / åˆ†æ”¯â€ã€‚é”™è¯¯çš„åˆ†è¯ä¼šç›´æ¥å¯¼è‡´åç»­è¯­ä¹‰ç†è§£çš„å½»åº•å¤±è´¥ã€‚ä¸­æ–‡åˆ†è¯æŠ€æœ¯ç»å†äº†ä»åŸºäºè¯å…¸çš„åŒ¹é…æ–¹æ³•ï¼Œåˆ°åŸºäºç»Ÿè®¡çš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼ˆå¦‚éšé©¬å°”å¯å¤«æ¨¡å‹ã€æ¡ä»¶éšæœºåœºï¼‰ï¼Œå†åˆ°å¦‚ä»ŠåŸºäºæ·±åº¦å­¦ä¹ åºåˆ—æ ‡æ³¨æ–¹æ³•çš„æ¼”è¿›ã€‚ç°ä»£åˆ†è¯å·¥å…·ï¼ˆå¦‚Jiebaã€HanLPï¼‰å·²ç»èƒ½å¤Ÿè¾¾åˆ°å¾ˆé«˜çš„å‡†ç¡®ç‡ï¼Œä½†å®ƒä»¬ä¾ç„¶é¢ä¸´æ­§ä¹‰åˆ‡åˆ†ï¼ˆå¦‚â€œä¹’ä¹“çƒæ‹/å–/å®Œäº†â€ vs â€œä¹’ä¹“çƒ/æ‹å–/å®Œäº†â€ï¼‰ã€æ–°è¯å‘ç°ç­‰æŒ‘æˆ˜ã€‚

åˆ†è¯ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ç³»åˆ—ç¦»æ•£çš„ç¬¦å·ï¼ˆè¯è¯­ï¼‰ã€‚ä½†æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ— è®ºæ˜¯ç®€å•çš„é€»è¾‘å›å½’è¿˜æ˜¯å¤æ‚çš„Transformerï¼Œå…¶æœ¬è´¨éƒ½æ˜¯è¿›è¡Œæ•°å­¦è¿ç®—ã€‚å®ƒä»¬æ— æ³•ç›´æ¥å¤„ç†â€œçŒ«â€ã€â€œç‹—â€è¿™æ ·çš„ç¬¦å·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•ï¼Œå°†è¿™äº›ç¬¦å·æ•°å€¼åŒ–ï¼Œå³è½¬æ¢ä¸ºæ¨¡å‹èƒ½å¤Ÿå¤„ç†çš„æ•°å­—å½¢å¼ã€‚æœ€ç›´è§‚çš„æ–¹æ³•æ˜¯ç‹¬çƒ­ç¼–ç ã€‚

ç‹¬çƒ­ç¼–ç ä¸ºè¯å…¸ä¸­çš„æ¯ä¸ªè¯åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ã€å¾ˆé•¿çš„äºŒè¿›åˆ¶å‘é‡ã€‚å‘é‡çš„é•¿åº¦ç­‰äºè¯å…¸çš„å¤§å°ï¼ˆæ¯”å¦‚50000ä¸ªè¯ï¼‰ã€‚å¯¹äºæŸä¸ªç‰¹å®šçš„è¯ï¼Œå®ƒçš„å‘é‡è¡¨ç¤ºåªæœ‰åœ¨å¯¹åº”è¯å…¸ç´¢å¼•çš„ä½ç½®ä¸Šæ˜¯1ï¼Œå…¶ä»–ä½ç½®å…¨æ˜¯0ã€‚ä¾‹å¦‚ï¼š
â€¢   â€œçŒ«â€ = [1, 0, 0, 0, ..., 0]

â€¢   â€œç‹—â€ = [0, 1, 0, 0, ..., 0]

â€¢   â€œæ•°å­¦â€ = [0, 0, 1, 0, ..., 0]

è¿™ç§æ–¹æ³•ç®€å•æ˜äº†ï¼Œä½†å­˜åœ¨ä¸¤ä¸ªè‡´å‘½ç¼ºé™·ï¼š1. ç»´åº¦ç¾éš¾ï¼šè¯å…¸åŠ¨è¾„æ•°ä¸‡è¯ï¼Œå‘é‡ç»´åº¦æé«˜ï¼Œè®¡ç®—å’Œå­˜å‚¨æ•ˆç‡ä½ä¸‹ã€‚2. è¯­ä¹‰é¸¿æ²Ÿï¼šæ¯ä¸ªè¯éƒ½è¢«è¡¨ç¤ºä¸ºå®Œå…¨ç‹¬ç«‹çš„å‘é‡ï¼Œæ— æ³•ä½“ç°è¯ä¸è¯ä¹‹é—´çš„ä»»ä½•å…³ç³»ã€‚â€œçŒ«â€å’Œâ€œç‹—â€éƒ½æ˜¯å® ç‰©ï¼Œè¯­ä¹‰ä¸Šå¾ˆæ¥è¿‘ï¼Œä½†å®ƒä»¬çš„ç‹¬çƒ­å‘é‡ç‚¹ç§¯ä¸º0ï¼Œæ¨¡å‹æ— æ³•æ„ŸçŸ¥è¿™ç§ç›¸ä¼¼æ€§ã€‚è¿™å¼•å‡ºäº†ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šæˆ‘ä»¬èƒ½å¦æ‰¾åˆ°ä¸€ç§æ›´å¥½çš„è¯è¯­è¡¨ç¤ºæ–¹æ³•ï¼Œæ—¢èƒ½é™ä½ç»´åº¦ï¼Œåˆèƒ½æ•æ‰è¯è¯­çš„è¯­ä¹‰ä¿¡æ¯ï¼Ÿ

ç¬¬å››ç« ï¼šé©å‘½çš„ç§å­â€”â€”Word2Vecä¸è¯å‘é‡çš„è¯ç”Ÿ

â€œWord2Vecå¯ä»¥å°†è¯è¯­è½¬æ¢ä¸ºå‘é‡â€ï¼Œè€Œâ€œè¯å‘é‡èƒ½å¤Ÿæ•æ‰è¯è¯­çš„è¯­ä¹‰ä¿¡æ¯â€ã€‚è¿™æ­£æ˜¯Word2Vecåœ¨2013å¹´ç”±Tomas Mikolovç­‰äººåœ¨è°·æ­Œæå‡ºæ—¶ï¼Œä¸ºNLPé¢†åŸŸå¸¦æ¥çš„é©å‘½æ€§çªç ´ã€‚å®ƒæˆåŠŸåœ°è§£å†³äº†ç‹¬çƒ­ç¼–ç çš„å¼Šç«¯ï¼Œæä¾›äº†ä¸€ç§å°†è¯è¯­æ˜ å°„åˆ°ä½ç»´ã€ç¨ å¯†å®æ•°å‘é‡ç©ºé—´çš„æ–¹æ³•ã€‚

è¿™äº›ä½ç»´å‘é‡ï¼ˆé€šå¸¸50ç»´åˆ°300ç»´ï¼‰è¢«ç§°ä¸ºè¯åµŒå…¥ã€‚Word2Vecçš„æ ¸å¿ƒæ€æƒ³æºäºåˆ†å¸ƒå‡è¯´ï¼šâ€œä¸€ä¸ªè¯çš„å«ä¹‰å¯ä»¥ç”±å®ƒå‘¨å›´çš„è¯æ¥å®šä¹‰â€ã€‚æ¢å¥è¯è¯´ï¼Œå‡ºç°åœ¨ç›¸ä¼¼ä¸Šä¸‹æ–‡ä¸­çš„è¯è¯­ï¼Œå…¶å«ä¹‰ä¹Ÿç›¸è¿‘ã€‚Word2Vecé€šè¿‡ä¸€ä¸ªæµ…å±‚ç¥ç»ç½‘ç»œæ¨¡å‹æ¥å­¦ä¹ è¿™ç§ä¸Šä¸‹æ–‡å…³ç³»ï¼Œä»è€Œå¾—åˆ°è¯çš„å‘é‡è¡¨ç¤ºã€‚

Word2Vecä¸»è¦æœ‰ä¸¤ç§æ¨¡å‹æ¶æ„ï¼šCBOWå’ŒSkip-gramã€‚
â€¢   è¿ç»­è¯è¢‹æ¨¡å‹ï¼šCBOWæ¨¡å‹çš„è®­ç»ƒç›®æ ‡æ˜¯æ ¹æ®ä¸Šä¸‹æ–‡è¯è¯­æ¥é¢„æµ‹ä¸­å¿ƒè¯ã€‚ä¾‹å¦‚ï¼Œç»™å®šå¥å­â€œThe ___ sat on the matâ€ï¼Œæ¨¡å‹éœ€è¦æ ¹æ®ä¸Šä¸‹æ–‡â€œThe", â€œsat", â€œon", â€œthe", â€œmatâ€æ¥é¢„æµ‹å‡ºä¸­å¿ƒè¯â€œcatâ€ã€‚CBOWåœ¨è®­ç»ƒæ—¶å°†æ‰€æœ‰çš„ä¸Šä¸‹æ–‡è¯å‘é‡æ±‚å¹³å‡åè¾“å…¥ç½‘ç»œï¼Œå› æ­¤å¾—åâ€œè¯è¢‹â€ã€‚å®ƒè®­ç»ƒé€Ÿåº¦å¿«ï¼Œå¯¹é«˜é¢‘è¯çš„è¡¨å¾æ›´å¥½ã€‚

â€¢   Skip-gramæ¨¡å‹ï¼šSkip-gramä¸CBOWç›¸åï¼Œå…¶è®­ç»ƒç›®æ ‡æ˜¯æ ¹æ®ä¸­å¿ƒè¯æ¥é¢„æµ‹å…¶å‘¨å›´çš„ä¸Šä¸‹æ–‡è¯è¯­ã€‚ä¾‹å¦‚ï¼Œç»™å®šä¸­å¿ƒè¯â€œcatâ€ï¼Œæ¨¡å‹éœ€è¦é¢„æµ‹å‡ºå®ƒå‘¨å›´ä¸€å®šçª—å£å†…çš„è¯ï¼Œå¦‚â€œThe", â€œsat", â€œon", â€œthe", â€œmatâ€ã€‚Skip-gramåœ¨å¤„ç†å°å‹æ•°æ®é›†å’Œç¨€æœ‰è¯æ—¶è¡¨ç°æ›´å¥½ï¼Œèƒ½æä¾›æ›´ç²¾ç»†çš„å‘é‡è¡¨ç¤ºã€‚

è®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹ä¸¢å¼ƒæ‰ç”¨äºé¢„æµ‹çš„è¾“å‡ºå±‚ï¼Œåªä¿ç•™éšè—å±‚çš„æƒé‡çŸ©é˜µã€‚è¿™ä¸ªçŸ©é˜µçš„æ¯ä¸€è¡Œï¼Œå°±å¯¹åº”ç€è¯å…¸ä¸­ä¸€ä¸ªè¯çš„è¯å‘é‡ã€‚è¿™äº›å‘é‡çš„ç¥å¥‡ä¹‹å¤„åœ¨äºï¼Œå®ƒä»¬ä¸ä»…æ˜¯ä¸€ä¸ªæ•°å­—æ ‡è¯†ç¬¦ï¼Œå…¶åœ¨é«˜ç»´ç©ºé—´ä¸­çš„å‡ ä½•å…³ç³»æ°å¥½ç¼–ç äº†è¯è¯­çš„è¯­ä¹‰å’Œè¯­æ³•å…³ç³»ã€‚

â€¢   è¯­ä¹‰ç›¸ä¼¼æ€§ï¼šè¯­ä¹‰ç›¸è¿‘çš„è¯ï¼Œå…¶å‘é‡åœ¨ç©ºé—´ä¸­çš„è·ç¦»ï¼ˆå¦‚ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ä¼šå¾ˆè¿‘ã€‚ä¾‹å¦‚ï¼Œâ€œå›½ç‹â€å’Œâ€œç‹åâ€çš„å‘é‡è·ç¦»ï¼Œä¼šè¿œå°äºâ€œå›½ç‹â€å’Œâ€œè‹¹æœâ€çš„è·ç¦»ã€‚

â€¢   ç±»æ¯”å…³ç³»ï¼šè¯å‘é‡ç©ºé—´å¯ä»¥è¿›è¡Œç»å…¸çš„å‘é‡è¿ç®—ã€‚æœ€è‘—åçš„ä¾‹å­æ˜¯ï¼švec(â€œå›½ç‹â€) - vec(â€œç”·äººâ€) + vec(â€œå¥³äººâ€) â‰ˆ vec(â€œç‹åâ€)ã€‚ç±»ä¼¼çš„ï¼Œvec(â€œåŒ—äº¬â€) - vec(â€œä¸­å›½â€) + vec(â€œæ³•å›½â€) â‰ˆ vec(â€œå·´é»â€)ã€‚è¿™è¡¨æ˜æ¨¡å‹å·²ç»æ•æ‰åˆ°äº†â€œé¦–éƒ½-å›½å®¶â€è¿™ç§æŠ½è±¡çš„è¯­ä¹‰å…³ç³»ã€‚

è¯å‘é‡çš„å‡ºç°ï¼Œä½¿å¾—è¯­ä¹‰ç›¸ä¼¼åº¦è¿™ä¸€NLPæ ¸å¿ƒä»»åŠ¡çš„å®ç°å˜å¾—å‰æ‰€æœªæœ‰çš„ç›´æ¥å’Œæœ‰æ•ˆã€‚â€œè¯­ä¹‰ç›¸ä¼¼åº¦æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†çš„é‡è¦ä»»åŠ¡â€ï¼Œå®ƒåœ¨ä¿¡æ¯æ£€ç´¢ã€æ™ºèƒ½é—®ç­”ã€é‡å¤æ£€æµ‹ã€æ¨èç³»ç»Ÿç­‰åœºæ™¯ä¸­è‡³å…³é‡è¦ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè¡¡é‡ä¸¤ä¸ªè¯æˆ–ä¸¤æ®µæ–‡æœ¬çš„ç›¸ä¼¼åº¦éå¸¸å›°éš¾ï¼Œé€šå¸¸ä¾èµ–äºäººå·¥æ„å»ºçš„åŒä¹‰è¯è¯å…¸ï¼ˆå¦‚WordNetï¼‰æˆ–å¤æ‚çš„è¯­ä¹‰åˆ†æã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—ä¸¤ä¸ªè¯å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªé‡åŒ–çš„ã€æœ‰è¯´æœåŠ›çš„è¯­ä¹‰ç›¸å…³æ€§åˆ†æ•°ã€‚è¿™ä¸ºä¸‹æ¸¸çš„NLPåº”ç”¨ï¼ˆå¦‚æƒ…æ„Ÿåˆ†æã€æ–‡æœ¬åˆ†ç±»ã€æœºå™¨ç¿»è¯‘ï¼‰æä¾›äº†å¼ºå¤§çš„ç‰¹å¾è¡¨ç¤ºåŸºç¡€ã€‚

ç¬¬äº”ç« ï¼šæ·±åº¦çš„åŠ›é‡â€”â€”æ·±åº¦å­¦ä¹ ä¸ç¥ç»ç½‘ç»œ

â€œæ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸâ€ï¼Œè€Œâ€œç¥ç»ç½‘ç»œç”±å¤šä¸ªç¥ç»å…ƒç›¸äº’è¿æ¥ç»„æˆâ€ã€‚æ·±åº¦å­¦ä¹ å¹¶éå…¨æ–°çš„æ¦‚å¿µï¼Œå…¶åŸºç¡€â€”â€”äººå·¥ç¥ç»ç½‘ç»œï¼Œæ—©åœ¨20ä¸–çºª40å¹´ä»£å°±å·²æå‡ºã€‚ä½†ç›´åˆ°æœ€è¿‘åå¹´ï¼Œç”±äºå¤§æ•°æ®ã€å¼ºå¤§ç®—åŠ›ï¼ˆç‰¹åˆ«æ˜¯GPUï¼‰å’Œç®—æ³•æ”¹è¿›ï¼ˆå¦‚ReLUæ¿€æ´»å‡½æ•°ã€Dropoutã€æ‰¹é‡å½’ä¸€åŒ–ï¼‰çš„ä¸‰é‡é©±åŠ¨ï¼Œæ·±åº¦å­¦ä¹ æ‰çˆ†å‘å‡ºå·¨å¤§çš„æ½œåŠ›ï¼Œå¹¶åœ¨å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«å’ŒNLPç­‰é¢†åŸŸå–å¾—äº†çªç ´æ€§è¿›å±•ã€‚

æ‰€è°“â€œæ·±åº¦â€ï¼ŒæŒ‡çš„æ˜¯ç¥ç»ç½‘ç»œä¸­éšè—å±‚çš„æ•°é‡è¾ƒå¤šã€‚ä¸€ä¸ªåŸºæœ¬çš„äººå·¥ç¥ç»å…ƒï¼Œä¹Ÿç§°ä½œæ„ŸçŸ¥æœºï¼Œæ˜¯å¯¹ç”Ÿç‰©ç¥ç»å…ƒçš„ç®€åŒ–æ¨¡æ‹Ÿã€‚å®ƒæ¥æ”¶å¤šä¸ªè¾“å…¥ä¿¡å·ï¼Œæ¯ä¸ªä¿¡å·ä¹˜ä»¥ä¸€ä¸ªæƒé‡ï¼ˆä»£è¡¨è¿æ¥å¼ºåº¦ï¼‰ï¼Œç„¶åå°†åŠ æƒå’Œé€šè¿‡ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚Sigmoidã€Tanhã€ReLUï¼‰äº§ç”Ÿè¾“å‡ºã€‚å•ä¸ªç¥ç»å…ƒèƒ½åŠ›æœ‰é™ï¼Œåªèƒ½è¿›è¡Œçº¿æ€§åˆ’åˆ†ã€‚

ä½†å½“æˆåƒä¸Šä¸‡ä¸ªè¿™æ ·çš„ç¥ç»å…ƒæŒ‰ç…§å±‚çº§ç»“æ„è¿æ¥èµ·æ¥æ—¶ï¼Œå°±å½¢æˆäº†ç¥ç»ç½‘ç»œã€‚è¾“å…¥å±‚çš„ç¥ç»å…ƒæ¥æ”¶åŸå§‹æ•°æ®ï¼ˆå¦‚å›¾åƒåƒç´ ã€è¯å‘é‡ï¼‰ï¼Œç»è¿‡ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚çš„é€å±‚å˜æ¢ï¼Œæœ€ç»ˆåœ¨è¾“å‡ºå±‚å¾—åˆ°ç»“æœã€‚æ¯ä¸€å±‚éƒ½å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªç‰¹å¾æå–å™¨ã€‚æµ…å±‚ç½‘ç»œå¯èƒ½å­¦ä¹ åˆ°ä¸€äº›è¾¹ç¼˜ã€çº¹ç†ç­‰ä½çº§ç‰¹å¾ï¼Œè€Œæ›´æ·±å±‚çš„ç½‘ç»œåˆ™èƒ½å¤Ÿç»„åˆè¿™äº›ä½çº§ç‰¹å¾ï¼Œå½¢æˆæ›´å¤æ‚ã€æ›´æŠ½è±¡çš„é«˜çº§ç‰¹å¾è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾åƒè¯†åˆ«ä¸­ï¼Œæ·±å±‚ç½‘ç»œå¯èƒ½é€æ­¥ç»„åˆå‡ºâ€œçœ¼ç›â€ã€â€œé¼»å­â€ã€â€œè½®å»“â€ç­‰æ¦‚å¿µï¼Œæœ€ç»ˆè¯†åˆ«å‡ºâ€œè¿™æ˜¯ä¸€å¼ äººè„¸â€ã€‚

åœ¨NLPé¢†åŸŸï¼Œç®€å•çš„ç¥ç»ç½‘ç»œï¼ˆå¦‚MLPï¼‰å¯ä»¥ç”¨äºæ–‡æœ¬åˆ†ç±»ç­‰ä»»åŠ¡ã€‚ä½†å¤„ç†åºåˆ—æ•°æ®ï¼ˆå¦‚å¥å­ï¼‰éœ€è¦æ›´ç‰¹æ®Šçš„ç»“æ„ï¼Œå› ä¸ºå¥å­ä¸­çš„è¯è¯­æ˜¯æœ‰é¡ºåºçš„ã€‚è¿™å‚¬ç”Ÿäº†å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰åŠå…¶å˜ä½“ï¼ˆå¦‚LSTMã€GRUï¼‰ã€‚RNNå…·æœ‰â€œè®°å¿†â€åŠŸèƒ½ï¼Œèƒ½å¤Ÿå¤„ç†å‰åä¾èµ–çš„åºåˆ—ä¿¡æ¯ï¼Œéå¸¸é€‚åˆè¯­è¨€å»ºæ¨¡ã€æœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡ã€‚ç„¶è€Œï¼ŒRNNå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸é—®é¢˜ï¼Œéš¾ä»¥æ•æ‰é•¿è·ç¦»ä¾èµ–ã€‚

2017å¹´ï¼ŒTransformeræ¨¡å‹æ¶æ„çš„æå‡ºï¼Œå½»åº•æ”¹å˜äº†NLPçš„æ ¼å±€ã€‚Transformerå®Œå…¨åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†åºåˆ—ä¸­çš„æ‰€æœ‰è¯ï¼Œå¹¶åŠ¨æ€åœ°è®¡ç®—æ¯ä¸ªè¯å¯¹äºå…¶ä»–æ‰€æœ‰è¯çš„æ³¨æ„åŠ›æƒé‡ï¼Œä»è€Œé«˜æ•ˆåœ°æ•æ‰é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚ä»¥Transformerä¸ºæ ¸å¿ƒæ„å»ºçš„å¤§å‹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œå¦‚BERTã€GPTç³»åˆ—ï¼Œæˆä¸ºäº†å½“ä»ŠNLPçš„ä¸»æµã€‚è¿™äº›æ¨¡å‹é¦–å…ˆåœ¨è¶…å¤§è§„æ¨¡è¯­æ–™åº“ä¸Šè¿›è¡Œæ— ç›‘ç£é¢„è®­ç»ƒï¼Œå­¦ä¹ é€šç”¨çš„è¯­è¨€è¡¨ç¤ºï¼Œç„¶ååªéœ€å°‘é‡çš„æ ‡æ³¨æ•°æ®é’ˆå¯¹ç‰¹å®šä»»åŠ¡è¿›è¡Œå¾®è°ƒï¼Œå°±èƒ½å–å¾—æä½³çš„æ€§èƒ½ã€‚å¯ä»¥è¯´ï¼ŒWord2Vecå¼€å¯äº†é™æ€è¯å‘é‡çš„æ—¶ä»£ï¼Œè€ŒBERTç­‰æ¨¡å‹åˆ™å°†ä¸Šä¸‹æ–‡ä¿¡æ¯åŠ¨æ€åœ°èå…¥æ¯ä¸ªè¯çš„è¡¨ç¤ºä¸­ï¼Œä½¿å¾—â€œä¸€è¯å¤šä¹‰â€å¾—åˆ°äº†å¾ˆå¥½çš„è§£å†³ã€‚

ç¬¬å…­ç« ï¼šåº”ç”¨ã€æŒ‘æˆ˜ä¸æœªæ¥å±•æœ›

è¯å‘é‡å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯å·²ç»æ·±åˆ»åœ°èå…¥äº†æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ã€‚æœç´¢å¼•æ“é€šè¿‡ç†è§£æŸ¥è¯¢è¯çš„è¯­ä¹‰ï¼Œè¿”å›æ›´ç›¸å…³çš„ç»“æœï¼›æ™ºèƒ½åŠ©æ‰‹ï¼ˆå¦‚Siriã€Alexaï¼‰èƒ½å¤Ÿè¿›è¡Œæµç•…çš„å¯¹è¯ï¼›æœºå™¨ç¿»è¯‘ï¼ˆå¦‚Google Translateï¼‰çš„è´¨é‡è¾¾åˆ°äº†å‰æ‰€æœªæœ‰çš„é«˜åº¦ï¼›ç¤¾äº¤åª’ä½“èƒ½å¤Ÿè‡ªåŠ¨è¿‡æ»¤æœ‰å®³ä¿¡æ¯ï¼›ç”µå­é‚®ä»¶ç³»ç»Ÿå¯ä»¥è‡ªåŠ¨åˆ†ç±»å’Œæ’°å†™å›å¤ã€‚

ç„¶è€Œï¼ŒNLPé¢†åŸŸä¾ç„¶é¢ä¸´ç€ä¸¥å³»çš„æŒ‘æˆ˜ã€‚
â€¢   åè§ä¸å…¬å¹³æ€§ï¼šæ¨¡å‹ä»äº’è”ç½‘æ•°æ®ä¸­å­¦åˆ°çš„äººç±»ç¤¾ä¼šåè§ï¼ˆæ€§åˆ«ã€ç§æ—ã€æ–‡åŒ–ç­‰ï¼‰å¯èƒ½ä¼šè¢«æ”¾å¤§å’Œå›ºåŒ–ï¼Œå¯¼è‡´ä¸å…¬å¹³çš„å†³ç­–ã€‚

â€¢   å¯è§£é‡Šæ€§ï¼šæ·±åº¦ç¥ç»ç½‘ç»œå¦‚åŒâ€œé»‘ç®±â€ï¼Œæˆ‘ä»¬éš¾ä»¥ç†è§£å…¶å†…éƒ¨å…·ä½“çš„å†³ç­–è¿‡ç¨‹ï¼Œè¿™åœ¨åŒ»ç–—ã€å¸æ³•ç­‰é«˜é£é™©é¢†åŸŸæ˜¯ä¸€ä¸ªé‡å¤§éšæ‚£ã€‚

â€¢   å¸¸è¯†æ¨ç†ï¼šæ¨¡å‹è™½ç„¶èƒ½å¤„ç†æµ·é‡æ–‡æœ¬çŸ¥è¯†ï¼Œä½†ç¼ºä¹äººç±»ä¸ç”Ÿä¿±æ¥çš„ç‰©ç†å¸¸è¯†å’Œç¤¾ä¼šå¸¸è¯†ï¼Œå®¹æ˜“çŠ¯ä¸‹ä½çº§çš„é€»è¾‘é”™è¯¯ã€‚

â€¢   æ•°æ®ä¾èµ–ä¸èƒ½è€—ï¼šè®­ç»ƒå¤§å‹æ¨¡å‹éœ€è¦å·¨å¤§çš„è®¡ç®—èµ„æºå’Œèƒ½æºæ¶ˆè€—ï¼Œå¼•å‘äº†å…³äºå…¶ç¯å¢ƒæˆæœ¬å’Œç»æµå¯è¡Œæ€§çš„æ€è€ƒã€‚

å±•æœ›æœªæ¥ï¼ŒNLPçš„ç ”ç©¶æ­£æœç€å‡ ä¸ªæ–¹å‘æ¼”è¿›ï¼š1. æ›´å¤§è§„æ¨¡ä¸å¤šæ¨¡æ€ï¼šæ¢ç´¢ä¸‡äº¿å‚æ•°çº§åˆ«çš„æ¨¡å‹ï¼Œå¹¶èåˆæ–‡æœ¬ã€å›¾åƒã€å£°éŸ³ç­‰å¤šæ¨¡æ€ä¿¡æ¯è¿›è¡Œå­¦ä¹ ã€‚2. æé«˜æ•ˆç‡ä¸é™ä½èƒ½è€—ï¼šç ”ç©¶æ¨¡å‹å‹ç¼©ã€çŸ¥è¯†è’¸é¦ã€æ›´é«˜æ•ˆçš„æ¶æ„ï¼Œè®©å¼ºå¤§çš„æ¨¡å‹èƒ½åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚3. å¢å¼ºå¯è§£é‡Šæ€§ä¸å¯æ§æ€§ï¼šè®©æ¨¡å‹çš„å†³ç­–è¿‡ç¨‹æ›´é€æ˜ã€æ›´ç¬¦åˆäººç±»çš„ä»·å€¼è§‚å’Œæ„å›¾ã€‚4. æ¢ç´¢æ–°çš„å­¦ä¹ èŒƒå¼ï¼šå¦‚å°æ ·æœ¬å­¦ä¹ ã€è‡ªç›‘ç£å­¦ä¹ ï¼Œå‡å°‘å¯¹å¤§é‡æ ‡æ³¨æ•°æ®çš„ä¾èµ–ã€‚

ç»“è®º

å›é¡¾æ•´ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ä»â€œè‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦åˆ†æ”¯â€è¿™ä¸€å®è§‚å‘½é¢˜å‡ºå‘ï¼Œé€æ­¥æ·±å…¥åˆ°â€œåˆ†è¯â€ã€â€œWord2Vecâ€ã€â€œè¯å‘é‡â€ã€â€œç¥ç»ç½‘ç»œâ€ç­‰å¾®è§‚æŠ€æœ¯ç»†èŠ‚ã€‚è¿™æ¡è·¯å¾„æ¸…æ™°åœ°å±•ç¤ºäº†ç°ä»£NLPçš„å‘å±•é€»è¾‘ï¼šä»¥æ•°æ®ä¸ºç‡ƒæ–™ï¼Œä»¥æœºå™¨å­¦ä¹ ä¸ºå¼•æ“ï¼Œé€šè¿‡è¯å‘é‡ç­‰æŠ€æœ¯å°†ç¬¦å·ä¸–ç•Œæ˜ å°„åˆ°å‘é‡ç©ºé—´ï¼Œå†åˆ©ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹å¼ºå¤§çš„å‡½æ•°æ‹Ÿåˆèƒ½åŠ›ï¼Œä»æ•°æ®ä¸­è‡ªåŠ¨å­¦ä¹ å¤æ‚çš„è¯­è¨€è§„å¾‹ã€‚Word2Vecä½œä¸ºå…¶ä¸­æ‰¿ä¸Šå¯ä¸‹çš„å…³é”®ä¸€ç¯ï¼Œä¸ä»…æœ¬èº«æ˜¯ä¸€é¡¹é«˜æ•ˆå®ç”¨çš„æŠ€æœ¯ï¼Œå…¶â€œç”±è¯åµŒå…¥è·å–è¯­ä¹‰â€çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ›´æ˜¯æ·±è¿œåœ°å½±å“äº†åç»­æ‰€æœ‰å¤§å‹è¯­è¨€æ¨¡å‹çš„è®¾è®¡å“²å­¦ã€‚

è‡ªç„¶è¯­è¨€å¤„ç†çš„é“è·¯ä¾ç„¶æ¼«é•¿ï¼Œè®©æœºå™¨çœŸæ­£ç†è§£äººç±»è¯­è¨€çš„å¥¥ç§˜ï¼Œæˆ–è®¸æ˜¯äººç±»èµ‹äºˆäººå·¥æ™ºèƒ½çš„æœ€è‰°å·¨ä¹Ÿæœ€è¿·äººçš„æŒ‘æˆ˜ä¹‹ä¸€ã€‚ä½†æ¯«æ— ç–‘é—®ï¼Œæˆ‘ä»¬å·²ç»è¸ä¸Šäº†ä¸€æ¡ç”±æ•°æ®ã€ç®—æ³•å’Œç®—åŠ›å…±åŒé“ºå°±çš„å¿«é€Ÿé“è·¯ï¼Œæ­£åœ¨ä¸æ–­é€¼è¿‘é‚£ä¸ªçœ‹ä¼¼é¥ä¸å¯åŠçš„ç»ˆæç›®æ ‡ã€‚"""
]

# æ–‡æœ¬é¢„å¤„ç†
def preprocess(text):
    text = re.sub(r'[^\w\s]', '', text)
    words = jieba.lcut(text)
    stopwords = {'çš„', 'æ˜¯', 'åœ¨', 'ä¸­', 'ç”±', 'ä¸º', 'å¯ä»¥', 'å°†', 'éœ€è¦'}
    return [w for w in words if w not in stopwords and len(w) > 1]

# å¤„ç†è¯­æ–™å¹¶è®­ç»ƒæ¨¡å‹
sentences = [preprocess(text) for text in corpus]
model = Word2Vec(sentences, vector_size=100, window=3, min_count=1, sg=1)  # Skip-gramæ¨¡å‹

# 2. æ¸¸æˆæ ¸å¿ƒé€»è¾‘
def word_guess_game():
    # ä»è¯æ±‡è¡¨ä¸­éšæœºé€‰æ‹©ç›®æ ‡è¯
    target_words = list(model.wv.key_to_index.keys())
    target = random.choice(target_words)
    
    # è·å–æœ€ç›¸ä¼¼çš„3ä¸ªè¯ï¼ˆæ’é™¤è‡ªèº«ï¼‰
    try:
        similar_words = [w for w, _ in model.wv.most_similar(target, topn=5) if w != target][:3]
    except:
        print("æ¸¸æˆåˆå§‹åŒ–å¤±è´¥ï¼Œæ¢ä¸€ä¸ªç›®æ ‡è¯é‡è¯•")
        return
    
    # æ¸¸æˆäº¤äº’
    print("\nğŸ® è¯ä¹‰çŒœè°œæ¸¸æˆï¼šæ ¹æ®ä»¥ä¸‹ç›¸ä¼¼è¯ï¼ŒçŒœå‡ºç›®æ ‡è¯ï¼ˆä¸­æ–‡ï¼‰")
    print(f"æç¤ºï¼šä¸è¿™äº›è¯æœ€ç›¸ä¼¼ -> {similar_words}")
    
    # å­¦ç”Ÿè¾“å…¥ç­”æ¡ˆï¼ˆå¯åœ¨Colabä¸­ç›´æ¥è¾“å…¥ï¼‰
    guess = input("è¯·è¾“å…¥ä½ çš„çŒœæµ‹ï¼š")
    
    # éªŒè¯ç­”æ¡ˆ
    if guess == target:
        # è®¡ç®—ç›¸ä¼¼åº¦ï¼ˆå±•ç¤ºæ¨¡å‹åˆ†æ•°ï¼‰
        similarity = model.wv.similarity(guess, similar_words[0])
        print(f"ğŸ‰ çŒœå¯¹äº†ï¼ç›®æ ‡è¯å°±æ˜¯ã€Œ{target}ã€")
        print(f"ç›¸ä¼¼åº¦å‚è€ƒï¼šä¸ã€Œ{similar_words[0]}ã€çš„ç›¸ä¼¼åº¦ä¸º {similarity:.2f}")
    else:
        print(f"âŒ çŒœé”™å•¦ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ã€Œ{target}ã€")

# å¯åŠ¨æ¸¸æˆ
if __name__ == "__main__":
    word_guess_game()
    # å¯å¤šæ¬¡è¿è¡Œï¼šprint("\nå†æ¥ä¸€å±€ï¼")ï¼›word_guess_game()
